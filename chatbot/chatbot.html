<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PoliteBot Chat</title>
<style>
  body { font-family: 'Segoe UI', Arial, sans-serif; margin:0; display:flex; justify-content:center; align-items:flex-start; padding-top:20px; transition:background 0.3s,color 0.3s; background:#f0f0f5; color:#000; }
  body.dark { background:#121212; color:#f0f0f0; }
  #container { width:500px; height:600px; background:white; border-radius:10px; box-shadow:0 0 12px rgba(0,0,0,0.2); display:flex; flex-direction:column; overflow:hidden; transition:background 0.3s,color 0.3s; }
  body.dark #container { background:#1e1e1e; }
  #chatBox { flex:1; padding:10px; overflow-y:auto; font-size:15px; white-space:pre-wrap; display:flex; flex-direction:column; gap:8px; }
  #typingIndicator { padding:8px; font-size:14px; color:gray; display:none; margin-left:10px; font-style:italic; }
  .message { display:flex; align-items:flex-end; opacity:0; transform:translateY(10px); animation:fadeIn 0.3s forwards; }
  @keyframes fadeIn { to { opacity:1; transform:translateY(0); } }
  .message.you { justify-content:flex-end; }
  .bubble { max-width:70%; padding:8px 12px; border-radius:15px; font-size:15px; line-height:1.3; }
  .you .bubble { background:#1a4bbb; color:white; border-bottom-right-radius:0; }
  .bot .bubble { background:#0b7a00; color:white; border-bottom-left-radius:0; }
  .bounce { animation:bounce 0.5s; }
  @keyframes bounce { 0%{transform:translateY(0);}50%{transform:translateY(-10px);}100%{transform:translateY(0);} }
  #bottom { padding:10px; display:flex; gap:10px; flex-wrap:wrap; background:#f4f4f6; }
  body.dark #bottom { background:#2c2c2c; }
  #inputBox { flex:1; padding:6px; font-size:15px; }
  button { width:110px; font-size:15px; cursor:pointer; }
  #commandsList { position:absolute; top:10px; right:10px; background:#eee; padding:10px; border-radius:8px; display:none; }
  body.dark #commandsList { background:#333; color:#f0f0f0; }
</style>
</head>
<body>
<div id="container">
  <div id="chatBox"></div>
  <div id="typingIndicator">PoliteBot is typingâ€¦</div>
  <div id="bottom">
    <input id="inputBox" type="text" placeholder="Type a message...">
    <button id="sendButton">Send</button>
    <button id="darkToggle">ğŸŒ™</button>
    <button id="clearButton">Clear</button>
    <button id="forgetButton">Forget</button>
    <button id="upgradeButton">Needs Upgrades</button>
    <button id="commandsButton">Commands</button>
  </div>
</div>
<div id="commandsList">
  Commands:<br>
  /fact<br>
  /joke<br>
  /meme<br>
  /dice<br>
  /coin<br>
  /memory<br>
  /time<br>
  /quiz
</div>

<script>
let memory = JSON.parse(localStorage.getItem('politebotMemory') || '[]');
let awaitingAnswer = false;
let pendingFact = "";

const funFacts = [
  "Octopuses have three hearts.",
  "A group of flamingos is called a 'flamboyance'.",
  "Wombat poop is cube-shaped.",
  "A cloud can weigh more than a million pounds.",
  "Bananas are berries, but strawberries are not."
];

const memeReactions = [
  "Bro is COOKING ğŸ”¥ğŸ”¥ğŸ”¥",
  "No cap thatâ€™s actually wild ğŸ˜­",
  "Skibidi facts fr ğŸ¤",
  "Bro got that W rizz ğŸ˜",
  "Ohio behavior ğŸ’€ (jk lol)",
  "Sigma move tbh ğŸ˜ˆ",
  "NPC moment ğŸ’€",
  "Fanum tax took that one fr ğŸ˜­",
  "Goofy ahh energy detected ğŸ˜­ğŸ‘",
  "GYATTT ğŸ˜‚",
  "Bro dropped a whole meme bomb ğŸ’£ğŸ˜‚",
  "Real Gigachad energy ğŸ’ªğŸ˜¤"
];

const knowledge = {
  "capital of france": "Paris ğŸ‡«ğŸ‡·",
  "largest planet": "Jupiter ğŸª",
  "fastest land animal": "Cheetah ğŸ†",
  "hello": "Hi there! ğŸ˜„"
};

function maybeFact() { return Math.random() < 0.25 ? funFacts[Math.floor(Math.random()*funFacts.length)] : null; }

// --- Word problem solver ---
function solveWordProblem(sentence) {
  sentence = sentence.toLowerCase();
  sentence = sentence.replace(/hiw/g,"how");
  const verbs = {"eat":"-","lose":"-","gave":"-","give":"-","get":"+","buy":"+","receive":"+","got":"+"};
  let numbers = sentence.match(/\d+/g)?.map(Number) || [];
  if(numbers.length<2) return null; 
  let op = null;
  for(let verb in verbs) if(sentence.includes(verb)){op=verbs[verb]; break;}
  if(!op) return null;
  let result = numbers[0];
  for(let i=1;i<numbers.length;i++){ if(op=="+") result+=numbers[i]; if(op=="-") result-=numbers[i]; }
  return result;
}

// --- Chat logic ---
function chatLogic(userInput){
  let trimmed = userInput.trim();
  let response="", emotion="ğŸ˜„";

  if(awaitingAnswer){
    memory.push(new Date().toISOString().slice(0,10)+": "+pendingFact+" â†’ "+trimmed);
    localStorage.setItem('politebotMemory', JSON.stringify(memory));
    awaitingAnswer = false;
    pendingFact = "";
    return {response:"Ooh! Got it ğŸ˜ Iâ€™ll remember that!", emotion:"ğŸ˜„"};
  }

  if(trimmed.toLowerCase().startsWith("did u know")){
    pendingFact = trimmed.substring(9).trim();
    awaitingAnswer = true;
    return {response:"Ooh! I don't know that! Tell me about it!", emotion:"ğŸ¤”"};
  }

  const memeWords = ["skibidi","rizz","sigma","ohio","fanum","npc","goofy","gyatt","cap","no cap","bro","goofy ahh"];
  for(let w of memeWords) if(trimmed.toLowerCase().includes(w)) return {response:memeReactions[Math.floor(Math.random()*memeReactions.length)], emotion:"ğŸ”¥"};

  const mathResult = solveWordProblem(trimmed);
  if(mathResult!==null) return {response:`The answer is **${mathResult}** ğŸ§ `, emotion:"ğŸ˜"};

  if(/^(exit|quit|bye)$/i.test(trimmed)) return {response:"Aight bye bestie ğŸ‘‹ğŸ˜„", emotion:"ğŸ˜Š"};

  if(trimmed.toLowerCase().startsWith("remember that")){
    let fact = trimmed.substring(13).trim();
    memory.push(new Date().toISOString().slice(0,10)+": "+fact);
    localStorage.setItem('politebotMemory', JSON.stringify(memory));
    return {response:"Bet, Iâ€™ll remember that ğŸ˜", emotion:"ğŸ˜„"};
  }

  let namePattern = /\b(?:my name is|i['â€™]?m|im|call me)\s+([A-Z][a-z]+)\b/i;
  let nameMatch = trimmed.match(namePattern);
  if(nameMatch){
    let name = nameMatch[1];
    memory.push(new Date().toISOString().slice(0,10)+": User's name is "+name);
    localStorage.setItem('politebotMemory', JSON.stringify(memory));
    return {response:`Yo ${name}! W name ğŸ˜„ğŸ”¥`, emotion:"ğŸ˜„"};
  }

  let feelPattern = /\b(i feel|feeling|feels|i['â€™]?m feeling|im feeling|i am)\s+(.+)/i;
  let feelMatch = trimmed.match(feelPattern);
  if(feelMatch){
    let feeling = feelMatch[2];
    memory.push(new Date().toISOString().slice(0,10)+": User felt "+feeling);
    localStorage.setItem('politebotMemory', JSON.stringify(memory));
    return {response:`Gotchu, you feelinâ€™ ${feeling}? Valid tbh ğŸ˜„`, emotion:"ğŸ˜Š"};
  }

  if(trimmed.length<3) return {response:"Bro typed the smallest message ever ğŸ˜­ whatâ€™s up?", emotion:"ğŸ˜„"};

  if(trimmed==="/fact") return {response:funFacts[Math.floor(Math.random()*funFacts.length)], emotion:"ğŸ¤“"};
  if(trimmed==="/joke"){
    let jokes=[
      "Why donâ€™t skeletons fight? They donâ€™t have the guts! ğŸ˜‚",
      "What has ears but canâ€™t hear? A cornfield! ğŸŒ½",
      "Why was the math book sad? Too many problems ğŸ˜„"
    ];
    return {response:jokes[Math.floor(Math.random()*jokes.length)], emotion:"ğŸ˜‚"};
  }
  if(trimmed==="/meme") return {response:memeReactions[Math.floor(Math.random()*memeReactions.length)], emotion:"ğŸ”¥"};
  if(trimmed==="/dice"){ let roll = Math.floor(Math.random()*6)+1; return {response:`You rolled a ${roll} ğŸ²`, emotion:"ğŸ˜"}; }
  if(trimmed==="/coin"){ let flip = Math.random()<0.5?"Heads":"Tails"; return {response:`Coin flipped: ${flip} ğŸª™`, emotion:"ğŸ˜"}; }
  if(trimmed==="/memory"){ return {response: memory.length? memory.join("\n"):"Nothing remembered yet ğŸ˜…", emotion:"ğŸ§ "}; }
  if(trimmed==="/time"){ return {response: `Current time: ${new Date().toLocaleTimeString()}`, emotion:"â°"}; }
  if(trimmed==="/quiz"){ return {response:"Quiz coming soon! ğŸ˜", emotion:"ğŸ§ "}; }

  for(let q in knowledge) if(trimmed.toLowerCase().includes(q)) return {response: knowledge[q], emotion:"ğŸ˜"};

  if(/^(hi|hello|hey|yo|sup)/i.test(trimmed)) return {response:["Yo! ğŸ˜","Hey bestie ğŸ‘‹","Wassup ğŸ˜„","Hiiiii ğŸ˜"][Math.floor(Math.random()*4)], emotion:"ğŸ˜Š"};

  if(trimmed.endsWith("?")) return {response:"Good question ngl ğŸ¤” what do *you* think?", emotion:"ğŸ¤”"};

  let generic = [
    "Real talk? Thatâ€™s kinda fire ğŸ”¥",
    "Valid take tbh ğŸ˜„",
    "Bro I feel that ğŸ˜­",
    "Interesting, tell me more ğŸ‘€",
    "Okay thatâ€™s lowkey cool ğŸ˜",
    "Not gonna lie thatâ€™s a W ğŸ‘"
  ];
  response = generic[Math.floor(Math.random()*generic.length)];
  let fact = maybeFact(); if(fact) response += " Also fun fact: "+fact;
  return {response, emotion};
}

// --- UI ---
const chatBox = document.getElementById("chatBox");
const typingIndicator = document.getElementById("typingIndicator");
const inputBox = document.getElementById("inputBox");
const sendButton = document.getElementById("sendButton");
const darkToggle = document.getElementById("darkToggle");
const clearButton = document.getElementById("clearButton");
const forgetButton = document.getElementById("forgetButton");
const upgradeButton = document.getElementById("upgradeButton");
const commandsButton = document.getElementById("commandsButton");
const commandsList = document.getElementById("commandsList");

function appendMessage(who,msg,emotion="ğŸ˜„"){
  let div = document.createElement("div");
  div.classList.add("message",who);
  let bubble = document.createElement("div");
  bubble.classList.add("bubble");
  bubble.innerHTML = who==="bot"? msg + " " + emotion : msg;
  if(who==="bot") bubble.classList.add("bounce");
  div.appendChild(bubble);
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function showTyping(){ typingIndicator.style.display="block"; }
function hideTyping(){ typingIndicator.style.display="none"; }

function botRespondSlowly(text, emotion){
  showTyping();
  setTimeout(()=>{ hideTyping(); appendMessage("bot",text,emotion); },400+Math.random()*600);
}

// --- Events ---
sendButton.onclick = ()=>{ 
  let text = inputBox.value.trim(); 
  if(text==="") return; 
  appendMessage("you",text); 
  let {response, emotion} = chatLogic(text); 
  botRespondSlowly(response, emotion); 
  inputBox.value="";
};

inputBox.addEventListener("keydown",e=>{ if(e.key==="Enter"){ e.preventDefault(); sendButton.click(); } });
darkToggle.onclick = ()=> document.body.classList.toggle("dark");
clearButton.onclick = ()=>{ chatBox.innerHTML=""; botRespondSlowly("Chat cleared ğŸ‘ memories safe.","ğŸ˜„"); };
forgetButton.onclick = ()=>{ chatBox.innerHTML=""; memory=[]; localStorage.removeItem('politebotMemory'); botRespondSlowly("Aight I forgot everything ğŸ˜„ start fresh!", "ğŸ˜„"); };
upgradeButton.onclick = ()=>{ botRespondSlowly("Please send messages to jacobcreation on GitHub! ğŸ˜„", "ğŸ“¢"); };
commandsButton.onclick = ()=>{
  commandsList.style.display="block";
  setTimeout(()=>{ commandsList.style.display="none"; },5000);
};

// --- Initial greeting ---
appendMessage("bot","Yo! Iâ€™m PoliteBot ğŸ˜ Drop a meme, math problem, or try the commands button!", "ğŸ˜„");
</script>
</body>
</html>
